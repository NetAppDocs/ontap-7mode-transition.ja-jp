---
permalink: copy-based/concept_how_you_transition_a_stand_alone_volume.html 
sidebar: sidebar 
keywords: ontap, copy, based, transition, stand, alone, volume 
summary: スタンドアロンボリュームの移行は、準備、データコピー、構成の適用（カットオーバー前）、およびストレージカットオーバーの各フェーズで構成されます。移行が完了したら、クライアントアクセスを再開する前に、移行後の手順を実行する必要があります。各フェーズで何が行われるかを把握しておくと、移行作業を効率的に管理できるようになります 
---
= スタンドアロンボリュームの移行方法
:icons: font
:imagesdir: ../media/


[role="lead"]
スタンドアロンボリュームの移行は、準備、データコピー、構成の適用（カットオーバー前）、およびストレージカットオーバーの各フェーズで構成されます。移行が完了したら、クライアントアクセスを再開する前に、移行後の手順を実行する必要があります。各フェーズで何が行われるかを把握しておくと、移行作業を効率的に管理できるようになります

image::../media/transition_singlevol.gif[次の図は、移行の各フェーズを示しています,such as preparation,data copy]

|===
| フェーズ | 手順 


 a| 
準備
 a| 
. 情報を収集しています
. 事前確認を実行
. データコピーのスケジュールを作成




 a| 
データコピー
 a| 
. ONTAP ボリュームを読み取り専用として作成します
. 移行ピア関係を作成
. SnapMirror 関係を確立する
. ベースライン転送を実行する
. スケジュールされた差分更新を実行します




 a| 
カットオーバー前
 a| 
. SnapMirror 関係を解除します
. 設定を SVM に適用する
. SVM にデータ LIF を設定
. データと構成をテストする（手動、カットオーバー前 RW のみが対象）
. ONTAP ボリュームと対応する 7-Mode ボリュームを再同期します




 a| 
ストレージカットオーバー
 a| 
. クライアントアクセスを切断する（手動）
. 最後の SnapMirror 更新を実行します
. SnapMirror 関係を解除します
. 7-Mode IP アドレスを削除し、データ LIF をに設定する SVM で up 状態になっている
. ソースボリュームをオフラインにしています


カットオーバー後、移行後の手順を実行してクライアントアクセスを有効にする（手動）



 a| 
SnapLock ボリュームの CoC 検証
 a| 
. 7-Mode ボリュームの WORM ファイルをすべて列挙しています
. 7-Mode の各 WORM ファイルのフィンガープリントを計算する 複数のボリューム（前の手順で列挙） とに、対応する WORM ファイルのフィンガープリントの計算方法を示します 移行した ONTAP ボリューム
. フィンガープリントが一致するファイルと一致しないファイルの数、および不一致の理由を記載したレポートを生成する


|===


== 準備フェーズ

このフェーズでは、 7-Mode システムとクラスタ、ボリューム、および IP アドレスに関する情報が収集されます。7-Mode Transition Tool がこのフェーズで実行するタスクは次のとおりです。

. 7-Mode ストレージシステムとボリュームの情報を収集して追加します。
. 移行の事前確認を実行します。
. クラスタ、 SVM 、およびアグリゲートの情報を収集して追加します。
. SVM に設定する必要がある IP アドレスを収集します。
+
** 7-Mode システムに存在する IP アドレスを選択します。
** SVM に設定する必要がある新しい IP アドレスを指定します。注： iSCSI LIF と FC LIF （ SAN ）の移行は、ツールではサポートされていません。移行の前に、 SVM に SAN LIF を手動で設定する必要があります。


. ベースラインコピーと差分更新のデータコピースケジュールを作成します。
. プロジェクトに SnapLock ボリュームが含まれている場合は、 CoC 検証を必要とする読み書き可能な SnapLock ボリュームに関する情報、および CoC 検証処理で生成されるフィンガープリントデータを格納する ONTAP ボリュームの詳細情報を収集します。
+

NOTE: CoC 検証処理は、名前に ASCII 文字のみを含むファイルが格納されているボリュームでのみサポートされます。

. ターゲット SVM およびターゲットボリュームに移行する必要がある 7-Mode 構成を選択して、構成の移行を計画します。


事前確認で報告されたエラーと警告を修正したあとに、コントローラ上のオブジェクト（ボリューム、 IP アドレス、システム情報など）を変更しないでください。



== データコピーフェーズ

このフェーズでは、 7-Mode ボリュームのデータが ONTAP ボリュームにコピーされます。7-Mode Transition Tool がこのフェーズで実行するタスクは次のとおりです。

. 読み取り専用アクセスが可能な ONTAP ボリュームを作成します。
. 7-Mode システムと SVM の間に移行ピア関係を設定します。
. 7-Mode ボリュームと ONTAP ボリュームの間に移行 SnapMirror 関係（ TDP タイプの関係）を確立します。
. スケジュール設定に基づいてベースラインデータコピー転送を実行します。
. ONTAP ボリュームに対してスケジュールされた差分更新を実行します。




== 構成の適用（カットオーバー前）フェーズ

計画したカットオーバー期間の数日 ~ 数週間前にカットオーバー前処理を実行することを推奨します。このアクティビティでは、すべての構成が適切に適用されているかどうか、何らかの変更が必要かどうかが検証されます。

このフェーズでは、 7-Mode ボリュームの構成が ONTAP ボリュームにコピーされます。

構成の適用（カットオーバー前）フェーズには、 * カットオーバー前読み取り専用 * モードと * カットオーバー前読み取り / 書き込み * モードの 2 つのモードがあります。

プロジェクトに次の要素が含まれている場合、カットオーバー前読み取り / 書き込みモードはサポートされません。

* SAN ボリュームとターゲットクラスタで Data ONTAP を実行している 8.3.1 以前
+
この場合、次の構成は構成の適用（カットオーバー前）フェーズでは適用されません。カットオーバーフェーズで適用されます。

+
** SAN 構成
** Snapshot スケジュールの設定


* SnapLock Compliance ボリューム
+
プロジェクトに SnapLock Compliance ボリュームが含まれている場合は、 Snapshot スケジュールの設定は構成の適用（カットオーバー前）フェーズでは適用されません。カットオーバーフェーズで適用されます。

+
xref:concept_considerations_for_transitioning_of_snaplock_compliance_volumes.adoc[SnapLock Compliance ボリュームの移行に関する考慮事項]



ターゲットクラスタが Data ONTAP 8.3.1 以前を実行している場合に、 NAS ボリュームに対して読み取り / 書き込みモードで構成の適用（カットオーバー前）処理を実行するには、 NAS ボリュームと SAN ボリュームで別々のプロジェクトを作成する必要があります。これは、カットオーバー前読み取り / 書き込みモードはプロジェクトに SAN ボリュームがあるとサポートされないためです。

プロジェクトに SnapLock Compliance ボリュームが含まれている場合に、非 SnapLock Compliance ボリュームに対して読み取り / 書き込みモードで構成の適用（カットオーバー前）処理を実行するには、 SnapLock Compliance ボリュームと非 SnapLock Compliance ボリュームで別々のプロジェクトを作成する必要があります。これは、カットオーバー前読み取り / 書き込みモードはプロジェクトに SnapLock Compliance ボリュームがあるとサポートされないためです。

カットオーバー前読み取り専用モード * では、次の手順が実行されます。

. 7-Mode ボリュームから ONTAP ボリュームに差分更新を実行します。
. 7-Mode ボリュームと ONTAP ボリューム間の SnapMirror 関係を解除します。
+

NOTE: SnapLock Compliance ボリュームの場合、 7-Mode ボリュームと ONTAP ボリュームの間の SnapMirror 関係は解除されません。7-Mode ボリュームと ONTAP ボリューム間の SnapMirror 再同期処理は SnapLock Compliance ボリュームではサポートされていないため、 SnapMirror 関係は解除されません。

. 7-Mode ボリュームの構成を収集し、 ONTAP ボリュームと SVM に適用します。
. SVM にデータ LIF を設定します。
+
** 管理ステータスが down になっている SVM では、既存の 7-Mode IP アドレスが作成されます。
** 管理ステータスが up になっている SVM では、新しい IP アドレスが作成されます。


. 7-Mode ボリュームと ONTAP ボリューム間の SnapMirror 関係を再同期します


カットオーバー前読み取り / 書き込みモード * では、次の手順が実行されます。

. 7-Mode ボリュームから ONTAP ボリュームに差分更新を実行します。
. 7-Mode ボリュームと ONTAP ボリューム間の SnapMirror 関係を解除します。
. 7-Mode ボリュームの構成を収集し、 ONTAP ボリュームと SVM に適用します。
. SVM にデータ LIF を設定します。
+
** 管理ステータスが down になっている SVM では、既存の 7-Mode IP アドレスが作成されます。
** 管理ステータスが up になっている SVM では、新しい IP アドレスが作成されます。


. ONTAP ボリュームに対する読み取り / 書き込みを可能にします。
+
構成の適用後に、 ONTAP ボリュームに対する読み取りと書き込みが可能になるため、構成の適用（カットオーバー前）のテスト時にはこれらのボリュームでデータの読み取り / 書き込みアクセスをテストできます。ONTAP で構成とデータアクセスを手動で検証できます。

. 「テストの終了」処理が手動で開始されたときに、 ONTAP ボリュームを再同期します。




== ストレージカットオーバーフェーズ

7-Mode Transition Tool がこのフェーズで実行するタスクは次のとおりです。

. オプション：カットオーバー後のダウンタイムを短縮するために SnapMirror 更新をオンデマンドで実行します。
. 手動： 7-Mode システムからクライアントアクセスを切断します。
. 7-Mode ボリュームから ONTAP ボリュームへの最後の SnapMirror 更新を実行します。
. 7-Mode ボリュームと ONTAP ボリュームの間の SnapMirror 関係を解除および削除して、 ONTAP ボリュームを読み取り / 書き込み可能にします。
+
選択したボリュームが SnapLock Compliance ボリュームで、かつ SnapMirror 関係のデスティネーションである場合、 7-Mode ボリュームと ONTAP ボリュームの間の SnapMirror 関係は解除されることなく削除されます。この操作は、セカンダリ ONTAP SnapLock Compliance ボリュームが読み取り専用モードのままとなるようにするために実行されます。プライマリとセカンダリの SnapLock Compliance ボリューム間の再同期処理が成功するためには、セカンダリ ONTAP SnapLock Compliance ボリュームが読み取り専用モードになっている必要があります。

. 次の場合に Snapshot スケジュールの設定を適用します。
+
** ターゲットクラスタが clustered Data ONTAP 8.3.0 または 8.3.1 を実行しており、プロジェクトに SAN ボリュームが含まれている。
** プロジェクトに SnapLock Compliance ボリュームが含まれている。


. ターゲットクラスタで Data ONTAP 8.3.1 以前が実行されている場合、 SAN 構成を適用します。
. クォータ構成があれば適用します。
. 7-Mode システムから移行対象として選択した既存の 7-Mode IP アドレスを削除し、 SVM 上のデータ LIF の管理状態を up にします。
+

NOTE: SAN LIF は 7-Mode Transition Tool では移行されません。

. オプション： 7-Mode ボリュームをオフラインにします。




== SnapLock ボリュームに対する CoC 検証プロセス

CoC 検証処理を実行する必要があります。CoC 検証を開始すると、ツールによって次の処理が実行されます。

. 7-Mode ボリュームの WORM ファイルをすべて列挙します。
. 列挙した各 WORM ファイルについて、 7-Mode ボリュームと移行した ONTAP ボリュームの両方でフィンガープリントを計算します。
. フィンガープリントが一致するファイルと一致しないファイルの数、および不一致の理由を記載したレポートを作成します。


[NOTE]
====
* CoC 検証処理は、名前に ASCII 文字のみを含むファイルが格納されている読み書き可能な SnapLock ボリュームでのみサポートされます。
* 7-Mode SnapLock ボリュームのファイル数によっては、この処理にはかなりの時間がかかることがあります。


====


== 移行後の手順

ストレージカットオーバーフェーズが正常に終了して移行が完了したら、移行後の手動タスクを実行する必要があります。

. 事前確認レポートに示された、移行されなかった機能または部分的に移行された機能を設定するために必要な手順を実行します。
+
たとえば、 IPv6 と FPolicy は、移行後に手動で設定する必要があります。

. SAN を移行する場合は、ホストを再設定します。
+
http://docs.netapp.com/ontap-9/topic/com.netapp.doc.dot-7mtt-sanspl/home.html["SAN ホストの移行および修復"]

. 次の点を検証し、 SVM がクライアントにデータを提供できる状態であることを確認します。
+
** SVM 上のボリュームがオンラインであり、読み取り / 書き込み可能である。
** IP アドレスが SVM 上で有効になっており、到達可能である。


. クライアントアクセスを ONTAP ボリュームにリダイレクトします。


* 関連情報 *

xref:task_transitioning_volumes_using_7mtt.adoc[7-Mode ボリュームからデータと構成をマイグレート]
